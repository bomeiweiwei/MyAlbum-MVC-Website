@model IEnumerable<MyAlbum.Models.Album.AlbumDto>

@{
    ViewData["Title"] = "會員相簿管理";
    Layout = "~/Views/Shared/_MemberLayout.cshtml";
}

<div class="d-flex justify-content-between align-items-center mb-3">
    <h3 class="mb-0">@ViewData["Title"]</h3>

    <!-- 新增相簿按鈕 -->
    <a class="btn btn-primary"
       asp-area="Member"
       asp-controller="Album"
       asp-action="Create">
        + 新增相簿
    </a>
</div>

<div class="row">
    @foreach (var item in Model)
    {
        <div class="col-12 col-md-4 mb-3">
            <div class="card" style="width:100%;">
                <img class="card-img-top"
                      src="@item.PublicCoverUrl"
                      style="height:240px; object-fit:cover;"
                      alt="@item.Title">
                <div class="card-body d-flex flex-column">
                    <h5 class="card-title">@item.Title</h5>
                    <p class="card-text text-secondary mb-1">評論數量：@item.TotalCommentNum</p>
                    <p class="card-text text-secondary mb-3">發佈時間：@item.ReleaseTimeUtc.ToLocalTime()</p>
                    <p class="mb-3">
                        狀態：
                        @if (item.Status == MyAlbum.Shared.Enums.Status.Active)
                        {
                            <span class="badge bg-success">啟用</span>
                        }
                        else
                        {
                            <span class="badge bg-secondary">停用</span>
                        }
                    </p>

                    <div class="mt-auto d-flex gap-2">
                        <!-- 圖片管理按鈕 -->
                        <a class="btn btn-outline-primary btn-sm"
                           asp-area="Member"
                           asp-controller="AlbumPhoto"
                           asp-action="Index"
                           asp-route-albumId="@item.AlbumId">
                            圖片管理
                        </a>

                        @if (item.Status == MyAlbum.Shared.Enums.Status.Active)
                        {
                            <form asp-area="Member"
                                  asp-controller="Album"
                                  asp-action="Disable"
                                  asp-route-albumId="@item.AlbumId"
                                  method="post"
                                  class="d-inline">
                                @Html.AntiForgeryToken()
                                <button type="submit"
                                        class="btn btn-outline-danger btn-sm"
                                        onclick="return confirm('確定要停用此相簿嗎？');">
                                    停用
                                </button>
                            </form>
                        }
                        else
                        {
                            <form asp-area="Member"
                                  asp-controller="Album"
                                  asp-action="Active"
                                  asp-route-albumId="@item.AlbumId"
                                  method="post"
                                  class="d-inline">
                                @Html.AntiForgeryToken()
                                <button type="submit"
                                        class="btn btn-outline-danger btn-sm"
                                        >
                                    啟用
                                </button>
                            </form>
                        }

                    </div>
                </div>
            </div>
        </div>
    }
</div>

